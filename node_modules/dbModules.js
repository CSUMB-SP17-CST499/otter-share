// All neo4j db operations here
var neo4j = require('neo4j-driver').v1;
var driver = neo4j.driver("bolt://localhost:7687", neo4j.auth.basic("neo4j", "root"));
var session = driver.session();

exports.findByEmail = (email) => {
  if (!!email) {
      session
          .run("MATCH (a:Person) WHERE a.email = {email} RETURN a.name AS name, a.email AS email, a.location AS location", {
              email: email
          })
          .then((result) => {
              let result_string = '';

              result.records.forEach((record) => {
                  //console.log(record._fields);
                  result_string += record._fields + ' ';
                  //delimits by comma
              });
              res.send(result_string);
          })
          .catch((e) => {
              //return ('error : ' + JSON.stringify(e));
              return e;
          });
  } else {
      return null;
  }
}
